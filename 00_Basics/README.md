Refer Example 4 for a bolier plate code.
1.
Pass argument as "data\sample.csv" for this example

2.
Use the below as the VM Options in the Run Configurations of IntellJ
-Dlog4j.configuration=file:log4j.properties
-Dlogfile.name=hello-world-spark
-Dspark.yarn.app.container.log.dir=app-logs


3.
Download winutil.exe
https://github.com/rahulsing/winutils/blob/master/hadoop-3.0.1/bin/winutils.exe
